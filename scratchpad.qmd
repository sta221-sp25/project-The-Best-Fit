---
title: "Project Proposal"
author: "The BEST Fit - Olivia Encarcion, Leo Yang, Philip Lin, Allison Yang"
format: pdf
execute: 
  warning: false
editor: visual
---

```{r}
#| label: load-pkg-data
library(tidyverse)
library(tidymodels)
library(ggplot2)
library(dplyr)
library(gridExtra)
library(knitr)
if (!requireNamespace("car", quietly = TRUE)) {
  install.packages("car")
}
library(car)

newsdf <- read_csv("data/OnlineNewsPopularity.csv")
```

```{r}
p1 <- ggplot(newsdf, aes(x = rate_positive_words, y = log(shares))) +
  geom_point( color = "blue") +
  geom_smooth(method = "lm", color = "red") +
  labs(title = "Log(Shares) vs Rate of Positive Words",
       x = "Rate of Positive Words", 
       y = "Log(Shares)") +
  theme_minimal()

p2 <- ggplot(newsdf, aes(x = rate_negative_words, y = log(shares))) +
  geom_point(color = "blue") +
  geom_smooth(method = "lm", color = "red") +
  labs(title = "Log(Shares) vs Rate of Negative Words",
       x = "Rate of Negative Words", 
       y = "Log(Shares)")
grid.arrange(p1, p2, ncol = 2)


```

```{r}
model <- lm(log(shares) ~ rate_negative_words + rate_positive_words, data =newsdf ) 
  tidy(model)|>
  kable(digits=3)

```

```{r}
vif_values <- vif(model)
print("Variance Inflation Factors:")
print(vif_values)
```

```{r}

title_fit_mod <- lm(log(shares) ~ n_tokens_title + data_channel * n_tokens_title + data_channel, data = newsdf) 
tidy(title_fit_mod) |>
  kable(digits = 3)

title_fit <- lm(log(shares) ~ title_sentiment_polarity + n_tokens_title + n_tokens_title * title_sentiment_polarity, data = newsdf) 
tidy(title_fit) |>
  kable(digits = 3)

```

From this model, we found that while the data channel type at times has a statistically significant linear relationship to log(shares), specifically for Social Media, Technology, and World, the number of words in the title does not have a linear relationship to log(shares), based on their respective p-values. For instance, the p-value for n_tokens_title is 0.677, thus suggesting that there is not a statistically significant linear relationship between n_tokens_title and log(shares). However, while the number of words in the title does not have a significant linear relationship with log(shares) directly, its interaction term specifically with when the data channel is World, is significant (as shown by the p-value of 0.003).

```{r}
newsdf |>
  filter(!is.na(data_channel)) |>
  ggplot(aes(x = n_tokens_title, y = log(shares), color = data_channel)) +
  geom_point() +
  geom_smooth(method = "lm")
```
